{% extends 'base.html' %}

{% block head %}
    {{ block.super }}
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawWeedayDistribution);
        google.charts.setOnLoadCallback(drawMonthDistribution);
        google.charts.setOnLoadCallback(drawYearsDistribution);

        {% if weekdays_distribution or months_distribution or years_distribution %}
            function drawWeedayDistribution() {

                var data = google.visualization.arrayToDataTable([
                    ['Weekday', 'Count'],
                    {% for weekday in weekdays_distribution|dictsort:"weekday" %}

                        ['{{ weekday.weekday }}', {{ weekday.count }}],

                    {% endfor %}
                ]);

                var options = {
                    titleTextStyle: {
                        fontSize: 18,
                        fontName: 'Ubuntu'
                    },
                    is3D: true,
                    title: 'Weekday Distribution'
                };

                var chart = new google.visualization.PieChart(document.getElementById('weekdayChart'));

                chart.draw(data, options);
            }

            function drawMonthDistribution() {

                var data = google.visualization.arrayToDataTable([
                    ['Month', 'Count'],
                    {% for month in months_distribution|dictsort:"month" %}

                        ['{{ month.month }}', {{ month.count }}],

                    {% endfor %}
                ]);

                var options = {
                    titleTextStyle: {
                        fontSize: 18,
                        fontName: 'Ubuntu'
                    },
                    is3D: true,
                    title: 'Month Distribution'
                };

                var chart = new google.visualization.PieChart(document.getElementById('monthChart'));

                chart.draw(data, options);
            }

            function drawYearsDistribution() {
                var data = google.visualization.arrayToDataTable([
                    ['Year', 'Count'],
                    {% for year in years_distribution|dictsort:"year" %}

                        ['{{ year.year }}', {{ year.count }}],

                    {% endfor %}


                ]);

                var options = {
                    titleTextStyle: {
                        fontSize: 18,
                        fontName: 'Ubuntu'
                    },
                    title: 'Year Distribution',
                    hAxis: {titleTextStyle: {color: '#333'}},
                    vAxis: {minValue: 0},
                    legend: { position: 'none' }

                };

                var chart = new google.visualization.AreaChart(document.getElementById('yearChart'));
                chart.draw(data, options);
            }

        {% endif %}

    </script>

{% endblock %}

{% block title %}Stats{% endblock %}


{% block content %}

    <div class="container">
        <div class="header">

            <h1>Statistics | {{ shows.count }} Shows |

                {% for item in get_request_stats %}

                    <span class="label label-default">{{ item.0|title }} :: {{ item.1|title }}</span>

                {% endfor %}

            </h1>
            <h3>

            </h3>

        </div>

        <hr/>
        <h2>Unique Song Count :: {{ song_count.song_count }}</h2>
        <h4>STS9 Originals ::</h4>
        <h4>Covers ::</h4>

        <hr/>


        <div class="panel-group">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" href="#test" style="text-decoration : none">
                            <span class="glyphicon glyphicon-collapse-down"></span><b>&nbsp;&nbsp;Shows Meeting Criteria</b></a>
                    </h4>
                </div>
                <div id="test" class="panel-collapse collapse">
                    <ul class="list-group">
                        {% for show in shows %}
                            <li class="list-group-item"><b><a href="/setlist/{{ show.id }}" title="{{ show }}">
                                {{ show.date.year }}.{{ show.date.month }}.{{ show.date.day }} </a>
                                :: {{ show.venue.name }} :: {{ show.venue.city }}, {{ show.venue.state }}
                                :: {{ show.venue.country }}</b></li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>

        {% if weekdays_distribution or months_distribution or years_distribution %}
            <hr/>

            <div id="weekdayChart" style="width: 600px; height: 300px;"></div>

            <hr/>
            <div id="monthChart" style="width: 600px; height:400px;"></div>

            <hr/>
            <div id="yearChart" style="width: 100%; height: 500px;"></div>

        {% endif %}


        <ul>

        </ul>

    </div>
{% endblock %}

